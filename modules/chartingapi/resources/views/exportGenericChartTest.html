<div id="buttons">
    <input type="button" id="next-btn" name="next-btn" onclick="nextChart();" value="Next" />
</div>
<div id="testDiv"></div>
<script type="text/javascript">
    var data = {
    	"schemaName":"study",
    	"queryName":"Lab Results",
    	"formatVersion":9.1,
    	"metaData":{"id":"lsid","title":"Lab Results","totalProperty":"rowCount","importTemplates":[{"label":"Download Template","url":"/labkey/query/Demo/exportExcelTemplate.view?schemaName=study&query.queryName=Lab%20Results&captionType=Name"}],"root":"rows","description":"Contains up to one row of Lab Results data for each Participant/Date combination.","importMessage":null,"fields":[{"ext":{},"name":"ParticipantId/Gender","friendlyType":"Text (String)","type":"string","jsonType":"string","sqlType":"VARCHAR","defaultValue":null,"fieldKey":"ParticipantId/Gender","fieldKeyArray":["ParticipantId","Gender"],"fieldKeyPath":"ParticipantId/Gender","isAutoIncrement":false,"autoIncrement":false,"isHidden":false,"hidden":false,"isKeyField":false,"keyField":false,"isMvEnabled":false,"mvEnabled":false,"isNullable":true,"nullable":true,"isReadOnly":false,"readOnly":false,"isUserEditable":false,"userEditable":false,"calculated":true,"isVersionField":false,"versionField":false,"isSelectable":true,"selectable":true,"shownInInsertView":false,"shownInUpdateView":false,"shownInDetailsView":true,"dimension":false,"measure":false,"protected":false,"excludeFromShifting":false,"conceptURI":null,"inputType":"text","shortCaption":"Gender","facetingBehaviorType":"AUTOMATIC","caption":"Gender"},{"ext":{},"name":"Lymphocytes","friendlyType":"Integer","type":"int","jsonType":"int","sqlType":"int4","defaultValue":null,"fieldKey":"Lymphocytes","fieldKeyArray":["Lymphocytes"],"fieldKeyPath":"Lymphocytes","isAutoIncrement":false,"autoIncrement":false,"isHidden":false,"hidden":false,"isKeyField":false,"keyField":false,"isMvEnabled":false,"mvEnabled":false,"isNullable":true,"nullable":true,"isReadOnly":false,"readOnly":false,"isUserEditable":true,"userEditable":true,"calculated":false,"isVersionField":false,"versionField":false,"isSelectable":true,"selectable":true,"shownInInsertView":true,"shownInUpdateView":true,"shownInDetailsView":true,"dimension":false,"measure":true,"protected":false,"excludeFromShifting":false,"conceptURI":null,"inputType":"text","shortCaption":"Lymphs (cells/mm3)","facetingBehaviorType":"AUTOMATIC","caption":"Lymphs (cells/mm3)"},{"ext":{},"name":"ParticipantId","description":"Subject identifier","friendlyType":"Text (String)","type":"string","jsonType":"string","sqlType":"varchar","defaultValue":null,"fieldKey":"ParticipantId","fieldKeyArray":["ParticipantId"],"fieldKeyPath":"ParticipantId","isAutoIncrement":false,"autoIncrement":false,"isHidden":false,"hidden":false,"isKeyField":false,"keyField":false,"isMvEnabled":false,"mvEnabled":false,"isNullable":false,"nullable":false,"isReadOnly":false,"readOnly":false,"isUserEditable":true,"userEditable":true,"calculated":false,"isVersionField":false,"versionField":false,"isSelectable":true,"selectable":true,"shownInInsertView":true,"shownInUpdateView":true,"shownInDetailsView":true,"dimension":true,"measure":false,"protected":false,"excludeFromShifting":false,"conceptURI":null,"importAliases":["ptid"],"inputType":"text","shortCaption":"Participant ID","facetingBehaviorType":"AUTOMATIC","caption":"Participant ID","lookup":{"keyColumn":"ParticipantId","schema":"study","displayColumn":"ParticipantId","schemaName":"study","queryName":"Participant","table":"Participant","isPublic":true,"public":true}},{"ext":{},"name":"CD4","friendlyType":"Integer","type":"int","jsonType":"int","sqlType":"int4","defaultValue":null,"fieldKey":"CD4","fieldKeyArray":["CD4"],"fieldKeyPath":"CD4","isAutoIncrement":false,"autoIncrement":false,"isHidden":false,"hidden":false,"isKeyField":false,"keyField":false,"isMvEnabled":false,"mvEnabled":false,"isNullable":true,"nullable":true,"isReadOnly":false,"readOnly":false,"isUserEditable":true,"userEditable":true,"calculated":false,"isVersionField":false,"versionField":false,"isSelectable":true,"selectable":true,"shownInInsertView":true,"shownInUpdateView":true,"shownInDetailsView":true,"dimension":false,"measure":true,"protected":false,"excludeFromShifting":false,"conceptURI":null,"inputType":"text","shortCaption":"CD4+ (cells/mm3)","facetingBehaviorType":"AUTOMATIC","caption":"CD4+ (cells/mm3)"},{"ext":{},"name":"lsid","friendlyType":"Text (String)","type":"string","jsonType":"string","sqlType":"varchar","defaultValue":null,"fieldKey":"lsid","fieldKeyArray":["lsid"],"fieldKeyPath":"lsid","isAutoIncrement":false,"autoIncrement":false,"isHidden":true,"hidden":true,"isKeyField":true,"keyField":true,"isMvEnabled":false,"mvEnabled":false,"isNullable":false,"nullable":false,"isReadOnly":false,"readOnly":false,"isUserEditable":false,"userEditable":false,"calculated":false,"isVersionField":false,"versionField":false,"isSelectable":true,"selectable":true,"shownInInsertView":false,"shownInUpdateView":false,"shownInDetailsView":true,"dimension":false,"measure":false,"protected":false,"excludeFromShifting":false,"conceptURI":null,"inputType":"text","shortCaption":"Lsid","facetingBehaviorType":"AUTOMATIC","caption":"Lsid"}]},"columnModel":[{"scale":0,"hidden":false,"width":10,"align":"left","sortable":true,"dataIndex":"ParticipantId/Gender","required":false,"header":"Gender","editable":false},{"scale":10,"hidden":false,"width":60,"align":"right","sortable":true,"dataIndex":"Lymphocytes","required":false,"header":"Lymphs (cells/mm3)","editable":true},{"scale":32,"hidden":false,"width":10,"align":"left","sortable":true,"dataIndex":"ParticipantId","required":true,"header":"Participant ID","editable":true,"tooltip":"Subject identifier"},{"scale":10,"hidden":false,"width":60,"align":"right","sortable":true,"dataIndex":"CD4","required":false,"header":"CD4+ (cells/mm3)","editable":true},{"scale":200,"hidden":true,"width":10,"align":"left","sortable":true,"dataIndex":"lsid","required":true,"header":"Lsid","editable":false}],"rows":[{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":-1},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1222},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20080429.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1224},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1235},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20080430.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":772},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1123},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20080528.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":390},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1271},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20080625.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":317},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1169},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20080723.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":271},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1039},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20080820.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":327},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1234},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20080917.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":271},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1080},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20081015.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":567},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1081},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20081112.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1020},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":882},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20081210.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1022},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":736},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090107.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1008},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1095},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090304.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1024},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1039},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090401.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":801},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1173},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090429.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1005},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1236},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090527.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1192},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1341},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090624.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":937},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1396},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090722.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1034},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1431},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090819.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":1005},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1372},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20090916.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":688},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1481},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20091014.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":764},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1672},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20091111.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":405},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1851},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20091209.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":223},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1722},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20100106.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":843},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1879},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20100203.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":462},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":2061},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20100303.0000"}},{"ParticipantId":{"value":"103866","url":"/labkey/study/Demo/participant.view?participantId=103866"},"CD4":{"value":701},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1974},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.103866.20100331.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1390},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":978},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20080429.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1457},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":974},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20080527.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":821},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1160},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20080624.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":517},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1310},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20080722.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":295},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1392},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20080819.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1076},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1523},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20080916.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1342},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1464},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20081014.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":877},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1615},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20081111.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":475},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1579},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20081209.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":736},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1660},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090106.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":434},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1768},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090203.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":272},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1954},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090303.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":391},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1803},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090331.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":725},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1848},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090428.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":459},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1798},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090526.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1182},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1743},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090721.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1493},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1615},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090818.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":764},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1626},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20090915.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":609},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1747},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20091013.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":625},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1635},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20091110.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":400},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1806},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20091208.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":950},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1952},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20100105.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":916},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":2105},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20100202.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":542},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1927},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20100302.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1090},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":2049},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20100330.0000"}},{"ParticipantId":{"value":"110349","url":"/labkey/study/Demo/participant.view?participantId=110349"},"CD4":{"value":1283},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":2108},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.110349.20100427.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":239},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1802},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20080420.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":266},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1787},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20080518.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":224},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1843},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20080615.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":163},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1780},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20080713.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":432},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1859},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20080810.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":954},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":2017},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20080907.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":1044},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":2185},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20081005.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":1094},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":2054},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20081102.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":1028},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":2085},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20081130.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":962},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":2099},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20081228.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":652},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":2121},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090125.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":386},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1975},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090222.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":653},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1870},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090322.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":530},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1953},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090419.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":366},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1777},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090517.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":426},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1830},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090614.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":360},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1668},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090712.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":467},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1620},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090809.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":525},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1752},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20090906.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":351},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1551},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20091004.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":379},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1406},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20091101.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":594},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1397},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20091129.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":513},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1587},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20091227.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":546},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1759},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20100124.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":537},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1686},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20100221.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":279},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1609},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20100321.0000"}},{"ParticipantId":{"value":"119180","url":"/labkey/study/Demo/participant.view?participantId=119180"},"CD4":{"value":226},"ParticipantId/Gender":{"value":"Females"},"Lymphocytes":{"value":1707},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.119180.20100418.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":1190},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":1141},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20080428.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":757},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":999},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20080526.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":428},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":937},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20080623.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":291},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":825},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20080721.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":154},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":882},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20080818.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":157},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":949},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20080915.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":121},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":789},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20081013.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":108},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":692},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20081110.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":108},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":791},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20081208.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":148},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":966},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090105.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":101},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":922},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090202.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":523},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":965},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090302.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":690},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":877},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090330.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":681},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":770},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090427.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":727},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":784},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090525.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":741},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":896},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090622.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":451},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":780},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090720.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":524},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":970},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090817.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":749},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":802},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20090914.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":539},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":870},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20091012.0000"}},{"ParticipantId":{"value":"125478","url":"/labkey/study/Demo/participant.view?participantId=125478"},"CD4":{"value":340},"ParticipantId/Gender":{"value":"Males"},"Lymphocytes":{"value":821},"lsid":{"value":"urn:lsid:labkey.com:Study.Data-10176:5007.125478.20091109.0000"}}],"rowCount":2691};
    
    // Default scatter. Lymphs on y, CD4 on x.
    var scatterPlotOne = 
    {"width":null,"height":null,"renderType":"auto_plot","geomOptions":{"boxFillColor":"3366FF","lineColor":"000000","lineWidth":1,"opacity":0.5,"pointFillColor":"3366FF","pointSize":5},"scales":{"x":{"trans":"linear"},"y":{"trans":"linear"}},"labels":{"x":"CD4+ (cells/mm3)","y":"Lymphs (cells/mm3)","main":"Scatter Plot One"},"measures":{"y":{"label":"Lymphs (cells/mm3)","name":"Lymphocytes","hidden":false,"measure":true,"type":"int","displayFieldJsonType":"","normalizedType":"int"},"x":{"label":"CD4+ (cells/mm3)","name":"CD4","hidden":false,"measure":true,"type":"int","displayFieldJsonType":"","normalizedType":"int"}}};
    
    // Custom scatter: Custom labels, shape/color measures, custom size, custom opacity. Lymphs on y, CD4 on x.
    var scatterPlotTwo = 
    {"width":900,"height":900,"renderType":"auto_plot","geomOptions":{"boxFillColor":"3366FF","lineColor":"000000","lineWidth":1,"opacity":1,"pointFillColor":"3366FF","pointSize":8},"scales":{"x":{"trans":"linear"},"y":{"trans":"linear"}},"labels":{"x":"CD4","y":"Lymphs","main":"Scatter Plot Two (Custom)"},"measures":{"y":{"label":"Lymphs (cells/mm3)","name":"Lymphocytes","hidden":false,"measure":true,"type":"int","displayFieldJsonType":"","normalizedType":"int"},"x":{"label":"CD4+ (cells/mm3)","name":"CD4","hidden":false,"measure":true,"type":"int","displayFieldJsonType":"","normalizedType":"int"},"color":{"name":"ParticipantId/Gender","label":"Gender"},"shape":{"name":"ParticipantId/Gender","label":"Gender"}}};
    // Regular box plot, all defaults. Lymphs on y, gender on x.
    var boxPlotOne = {"width":null,"height":null,"renderType":"auto_plot","geomOptions":{"boxFillColor":"3366FF","lineColor":"000000","lineWidth":1,"opacity":0.5,"pointFillColor":"3366FF","pointSize":5},"scales":{"x":{"trans":"linear"},"y":{"trans":"linear"}},"labels":{"x":"Gender","y":"Lymphs (cells/mm3)","main":"Box Plot One"},"measures":{"y":{"label":"Lymphs (cells/mm3)","name":"Lymphocytes","hidden":false,"measure":true,"type":"int","displayFieldJsonType":"","normalizedType":"int"},"x":{"label":"Gender","name":"ParticipantId/Gender","hidden":false,"measure":false,"type":"string","displayFieldJsonType":"","normalizedType":"string"}}};

    // Customized box plot. Has point click function, custom colors, and color/shape grouping. 
    // Y axis has log scale, but invalid log data, so there should be an error message, but a chart should still render.CD4 on y, gender on x.
    var boxPlotTwo = 
    {"width":null,"height":null,"renderType":"auto_plot","geomOptions":{"boxFillColor":"333333","lineColor":"000000","lineWidth":1,"opacity":0.5,"pointFillColor":"3366FF","pointSize":5},"scales":{"x":{"trans":"linear"},"y":{"trans":"log"}},"labels":{"x":"Gender","y":"CD4","main":"Box Plot Two (Custom)"},"measures":{"y":{"label":"CD4+ (cells/mm3)","name":"CD4","hidden":false,"measure":true,"type":"int","displayFieldJsonType":"","normalizedType":"int"},"x":{"label":"Gender","name":"ParticipantId/Gender","hidden":false,"measure":false,"type":"string","displayFieldJsonType":"","normalizedType":"string"},"color":{"name":"ParticipantId/Gender","label":"Gender"},"shape":{"name":"ParticipantId/Gender","label":"Gender"},"pointClickFn":"function (data, measureInfo, clickEvent) {\n   var queryHref = LABKEY.ActionURL.buildURL('query', 'executeQuery', LABKEY.container.path, \n                      {schemaName: measureInfo[\"schemaName\"], \"query.queryName\": measureInfo[\"queryName\"]});\n\n   Ext4.Msg.alert('Data Point Information',\n       'Schema: ' + measureInfo[\"schemaName\"]\n       + '<br/> Query: <a href=\"' + queryHref + '\">' + measureInfo[\"queryName\"] + '</a>'\n       + '<br/>' + measureInfo[\"xAxis\"] + ': ' + (data[measureInfo[\"xAxis\"]].displayValue ? data[measureInfo[\"xAxis\"]].displayValue : data[measureInfo[\"xAxis\"]].value)\n       + '<br/>' + measureInfo[\"yAxis\"] + ': ' + (data[measureInfo[\"yAxis\"]].displayValue ? data[measureInfo[\"yAxis\"]].displayValue : data[measureInfo[\"yAxis\"]].value)\n   );\n}"}};
    
    // Same as Two, but uses Cohort on X axis, which is missing, so an error should be present but no chart.
    var boxPlotThree = 
    {"width":null,"height":null,"renderType":"auto_plot","geomOptions":{"boxFillColor":"333333","lineColor":"000000","lineWidth":1,"opacity":0.5,"pointFillColor":"3366FF","pointSize":5},"scales":{"x":{"trans":"linear"},"y":{"trans":"log"}},"labels":{"x":"Cohort","y":"CD4","main":"Box Plot Three (Custom, Broken)"},"measures":{"y":{"label":"CD4+ (cells/mm3)","name":"CD4","hidden":false,"measure":true,"type":"int","displayFieldJsonType":"","normalizedType":"int"},"x":{"label":"Cohort","name":"ParticipantId/Cohort","hidden":false,"measure":false,"type":"int","displayFieldJsonType":"string","normalizedType":"string"},"color":{"name":"ParticipantId/Gender","label":"Gender"},"shape":{"name":"ParticipantId/Gender","label":"Gender"},"pointClickFn":"function (data, measureInfo, clickEvent) {\n   var queryHref = LABKEY.ActionURL.buildURL('query', 'executeQuery', LABKEY.container.path, \n                      {schemaName: measureInfo[\"schemaName\"], \"query.queryName\": measureInfo[\"queryName\"]});\n\n   Ext4.Msg.alert('Data Point Information',\n       'Schema: ' + measureInfo[\"schemaName\"]\n       + '<br/> Query: <a href=\"' + queryHref + '\">' + measureInfo[\"queryName\"] + '</a>'\n       + '<br/>' + measureInfo[\"xAxis\"] + ': ' + (data[measureInfo[\"xAxis\"]].displayValue ? data[measureInfo[\"xAxis\"]].displayValue : data[measureInfo[\"xAxis\"]].value)\n       + '<br/>' + measureInfo[\"yAxis\"] + ': ' + (data[measureInfo[\"yAxis\"]].displayValue ? data[measureInfo[\"yAxis\"]].displayValue : data[measureInfo[\"yAxis\"]].value)\n   );\n}"}};

    var charts = [scatterPlotOne, scatterPlotTwo, boxPlotOne, boxPlotTwo, boxPlotThree];

    var renderMessages = function(id, messages) {
        var errorDiv;
        var el = document.getElementById(id);
        var child;
        if (el && el.children.length > 0) {
            child = el.children[0];
        }

        for (var i = 0; i < messages.length; i++) {
            errorDiv = document.createElement('div');
            errorDiv.setAttribute('class', 'labkey-error');
            errorDiv.innerHTML = messages[i];
            if(child) {
                el.insertBefore(errorDiv, child);
            } else {
                el.appendChild(errorDiv);
            }
        }
    };
    // Render chart is roughly what export as script produces.
    var renderChart = function(responseData, chartConfig) {
        // After the data is loaded we can render the chart.
        // chartConfig is the saved information about the chart (labels, scales, etc.)
        var gch = LABKEY.vis.GenericChartHelper;
        var DEFAULT_WIDTH = 800, DEFAULT_HEIGHT = 600;
        var chartType = gch.getChartType(chartConfig.renderType, chartConfig.measures.x.normalizedType);
        var layerConfig = {
            data: responseData.rows,
            geom: gch.generateGeom(chartType, chartConfig.geomOptions)
        };
        var aes = gch.generateAes(chartType, chartConfig.measures, responseData.schemaName, responseData.queryName);
        var scales = gch.generateScales(chartType, chartConfig.measures, chartConfig.scales, aes, responseData);
        var labels = gch.generateLabels(chartConfig.labels);
        var messages = [];
        var validation = gch.validateAxisMeasure(chartType, chartConfig, 'x', aes, scales, responseData.rows);
        
        if (validation.message != null) {
            messages.push(validation.message);
        }

        if (!validation.success) {
            renderMessages('testDiv', messages);
            return;
        }

        validation = gch.validateAxisMeasure(chartType, chartConfig, 'y', aes, scales, responseData.rows);

        if (validation.message != null) {
            messages.push(validation.message);
        }

        if (!validation.success) {
            renderMessages('testDiv', messages);
            return;
        }

        var plotConfig = {
            renderTo: 'testDiv',
            width: chartConfig.width ? chartConfig.width : DEFAULT_WIDTH,
            height: chartConfig.height? chartConfig.height : DEFAULT_HEIGHT,
            labels: labels,
            aes: aes,
            scales: scales,
            layers: [new LABKEY.vis.Layer(layerConfig)],
            data: responseData.rows
        }
        var plot = new LABKEY.vis.Plot(plotConfig);
        
        plot.render();
        renderMessages('testDiv', messages);
    };

    var chartIdx = 0;
    var nextChart = function(){
        chartIdx = chartIdx + 1;

        if(chartIdx == charts.length - 1) {
            document.getElementById('next-btn').setAttribute('disabled', 'true');
        }
        document.getElementById('testDiv').innerHTML = '';
        var chartConfig = charts[chartIdx];
        renderChart(data, chartConfig);
    };

    LABKEY.requiresScript('/vis/genericChart/genericChartHelper.js', function(){
        LABKEY.vis.GenericChartHelper.loadVisDependencies(function(){
            renderChart(data, charts[chartIdx]);
        });
    }, null, true);
</script>